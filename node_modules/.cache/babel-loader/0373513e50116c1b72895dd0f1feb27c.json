{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport { useIsUserInteractionMode } from \"../mode\";\nimport { useOnUnmount } from \"../useOnUnmount\";\nimport { DEFAULT_HOVER_MODE_STICKY_EXIT_TIME } from \"./constants\";\nimport { useHoverModeContext } from \"./useHoverModeContext\";\nexport function useHoverMode(_a) {\n  var _b = _a === void 0 ? {} : _a,\n      _c = _b.disabled,\n      disabled = _c === void 0 ? false : _c,\n      _d = _b.sticky,\n      sticky = _d === void 0 ? false : _d,\n      propOnClick = _b.onClick,\n      propOnMouseEnter = _b.onMouseEnter,\n      propOnMouseLeave = _b.onMouseLeave,\n      _e = _b.defaultVisible,\n      defaultVisible = _e === void 0 ? false : _e,\n      _f = _b.exitVisibilityDelay,\n      exitVisibilityDelay = _f === void 0 ? sticky ? DEFAULT_HOVER_MODE_STICKY_EXIT_TIME : 0 : _f;\n\n  var isTouch = useIsUserInteractionMode(\"touch\");\n\n  var _g = useState(defaultVisible),\n      visible = _g[0],\n      setVisible = _g[1];\n\n  var _h = useState(false),\n      stuck = _h[0],\n      setStuck = _h[1];\n\n  var enterTimeoutRef = useRef();\n  var exitTimeoutRef = useRef();\n\n  var _j = useHoverModeContext(),\n      visibleInTime = _j.visibleInTime,\n      enableHoverMode = _j.enableHoverMode,\n      disableHoverMode = _j.disableHoverMode,\n      startDisableTimer = _j.startDisableTimer;\n\n  var active = visibleInTime === 0;\n  useEffect(function () {\n    if (sticky && !visible) {\n      setStuck(false);\n    }\n  }, [visible, sticky]);\n  useOnUnmount(function () {\n    window.clearTimeout(enterTimeoutRef.current);\n    window.clearTimeout(exitTimeoutRef.current);\n  });\n  useEffect(function () {\n    if (isTouch || disabled) {\n      disableHoverMode();\n    }\n  }, [disableHoverMode, isTouch, disabled]);\n  var onMouseEnter = useCallback(function (event) {\n    propOnMouseEnter === null || propOnMouseEnter === void 0 ? void 0 : propOnMouseEnter(event);\n\n    if (stuck || disabled || isTouch || event.isPropagationStopped()) {\n      return;\n    }\n\n    window.clearTimeout(enterTimeoutRef.current);\n    window.clearTimeout(exitTimeoutRef.current);\n\n    if (visibleInTime === 0) {\n      enableHoverMode();\n      setVisible(true);\n      return;\n    }\n\n    enterTimeoutRef.current = window.setTimeout(function () {\n      enableHoverMode();\n      setVisible(true);\n    }, visibleInTime);\n  }, [disabled, enableHoverMode, isTouch, propOnMouseEnter, stuck, visibleInTime]);\n  var onMouseLeave = useCallback(function (event) {\n    propOnMouseLeave === null || propOnMouseLeave === void 0 ? void 0 : propOnMouseLeave(event);\n\n    if (stuck || disabled || isTouch || event.isPropagationStopped()) {\n      return;\n    }\n\n    startDisableTimer();\n    window.clearTimeout(enterTimeoutRef.current);\n    window.clearTimeout(exitTimeoutRef.current);\n\n    if (exitVisibilityDelay === 0) {\n      setVisible(false);\n      return;\n    }\n\n    exitTimeoutRef.current = window.setTimeout(function () {\n      setVisible(false);\n    }, exitVisibilityDelay);\n  }, [disabled, exitVisibilityDelay, isTouch, propOnMouseLeave, startDisableTimer, stuck]);\n  var onClick = useCallback(function (event) {\n    propOnClick === null || propOnClick === void 0 ? void 0 : propOnClick(event);\n\n    if (event.isPropagationStopped() || disabled) {\n      return;\n    }\n\n    startDisableTimer();\n    window.clearTimeout(enterTimeoutRef.current);\n    window.clearTimeout(exitTimeoutRef.current);\n  }, [disabled, propOnClick, startDisableTimer]);\n  var onStickyClick = useCallback(function (event) {\n    propOnClick === null || propOnClick === void 0 ? void 0 : propOnClick(event);\n\n    if (event.isPropagationStopped() || disabled) {\n      return;\n    }\n\n    if (!stuck) {\n      setStuck(true);\n      setVisible(true);\n      disableHoverMode();\n    } else {\n      setStuck(false);\n      setVisible(function (prevVisible) {\n        return !prevVisible;\n      });\n    }\n  }, [disableHoverMode, disabled, propOnClick, stuck]);\n  var handlers = {\n    onClick: onClick,\n    onMouseEnter: onMouseEnter,\n    onMouseLeave: onMouseLeave\n  };\n  var stickyHandlers;\n\n  if (sticky) {\n    stickyHandlers = __assign(__assign({}, handlers), {\n      onClick: onStickyClick\n    });\n  }\n\n  return {\n    active: active,\n    stuck: sticky ? stuck : undefined,\n    visible: visible,\n    setVisible: setVisible,\n    handlers: handlers,\n    stickyHandlers: stickyHandlers,\n    enableHoverMode: enableHoverMode,\n    disableHoverMode: disableHoverMode,\n    startDisableTimer: startDisableTimer\n  };\n}","map":{"version":3,"sources":["../../src/hover/useHoverMode.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { useCallback, useEffect, useRef, useState, } from \"react\";\nimport { useIsUserInteractionMode } from \"../mode\";\nimport { useOnUnmount } from \"../useOnUnmount\";\nimport { DEFAULT_HOVER_MODE_STICKY_EXIT_TIME } from \"./constants\";\nimport { useHoverModeContext } from \"./useHoverModeContext\";\nexport function useHoverMode(_a) {\n    var _b = _a === void 0 ? {} : _a, _c = _b.disabled, disabled = _c === void 0 ? false : _c, _d = _b.sticky, sticky = _d === void 0 ? false : _d, propOnClick = _b.onClick, propOnMouseEnter = _b.onMouseEnter, propOnMouseLeave = _b.onMouseLeave, _e = _b.defaultVisible, defaultVisible = _e === void 0 ? false : _e, _f = _b.exitVisibilityDelay, exitVisibilityDelay = _f === void 0 ? sticky ? DEFAULT_HOVER_MODE_STICKY_EXIT_TIME : 0 : _f;\n    var isTouch = useIsUserInteractionMode(\"touch\");\n    var _g = useState(defaultVisible), visible = _g[0], setVisible = _g[1];\n    var _h = useState(false), stuck = _h[0], setStuck = _h[1];\n    var enterTimeoutRef = useRef();\n    var exitTimeoutRef = useRef();\n    var _j = useHoverModeContext(), visibleInTime = _j.visibleInTime, enableHoverMode = _j.enableHoverMode, disableHoverMode = _j.disableHoverMode, startDisableTimer = _j.startDisableTimer;\n    var active = visibleInTime === 0;\n    useEffect(function () {\n        if (sticky && !visible) {\n            setStuck(false);\n        }\n    }, [visible, sticky]);\n    useOnUnmount(function () {\n        window.clearTimeout(enterTimeoutRef.current);\n        window.clearTimeout(exitTimeoutRef.current);\n    });\n    useEffect(function () {\n        if (isTouch || disabled) {\n            disableHoverMode();\n        }\n    }, [disableHoverMode, isTouch, disabled]);\n    var onMouseEnter = useCallback(function (event) {\n        propOnMouseEnter === null || propOnMouseEnter === void 0 ? void 0 : propOnMouseEnter(event);\n        if (stuck || disabled || isTouch || event.isPropagationStopped()) {\n            return;\n        }\n        window.clearTimeout(enterTimeoutRef.current);\n        window.clearTimeout(exitTimeoutRef.current);\n        if (visibleInTime === 0) {\n            enableHoverMode();\n            setVisible(true);\n            return;\n        }\n        enterTimeoutRef.current = window.setTimeout(function () {\n            enableHoverMode();\n            setVisible(true);\n        }, visibleInTime);\n    }, [disabled, enableHoverMode, isTouch, propOnMouseEnter, stuck, visibleInTime]);\n    var onMouseLeave = useCallback(function (event) {\n        propOnMouseLeave === null || propOnMouseLeave === void 0 ? void 0 : propOnMouseLeave(event);\n        if (stuck || disabled || isTouch || event.isPropagationStopped()) {\n            return;\n        }\n        startDisableTimer();\n        window.clearTimeout(enterTimeoutRef.current);\n        window.clearTimeout(exitTimeoutRef.current);\n        if (exitVisibilityDelay === 0) {\n            setVisible(false);\n            return;\n        }\n        exitTimeoutRef.current = window.setTimeout(function () {\n            setVisible(false);\n        }, exitVisibilityDelay);\n    }, [\n        disabled,\n        exitVisibilityDelay,\n        isTouch,\n        propOnMouseLeave,\n        startDisableTimer,\n        stuck,\n    ]);\n    var onClick = useCallback(function (event) {\n        propOnClick === null || propOnClick === void 0 ? void 0 : propOnClick(event);\n        if (event.isPropagationStopped() || disabled) {\n            return;\n        }\n        startDisableTimer();\n        window.clearTimeout(enterTimeoutRef.current);\n        window.clearTimeout(exitTimeoutRef.current);\n    }, [disabled, propOnClick, startDisableTimer]);\n    var onStickyClick = useCallback(function (event) {\n        propOnClick === null || propOnClick === void 0 ? void 0 : propOnClick(event);\n        if (event.isPropagationStopped() || disabled) {\n            return;\n        }\n        if (!stuck) {\n            setStuck(true);\n            setVisible(true);\n            disableHoverMode();\n        }\n        else {\n            setStuck(false);\n            setVisible(function (prevVisible) { return !prevVisible; });\n        }\n    }, [disableHoverMode, disabled, propOnClick, stuck]);\n    var handlers = {\n        onClick: onClick,\n        onMouseEnter: onMouseEnter,\n        onMouseLeave: onMouseLeave,\n    };\n    var stickyHandlers;\n    if (sticky) {\n        stickyHandlers = __assign(__assign({}, handlers), { onClick: onStickyClick });\n    }\n    return {\n        active: active,\n        stuck: sticky ? stuck : undefined,\n        visible: visible,\n        setVisible: setVisible,\n        handlers: handlers,\n        stickyHandlers: stickyHandlers,\n        enableHoverMode: enableHoverMode,\n        disableHoverMode: disableHoverMode,\n        startDisableTimer: startDisableTimer,\n    };\n}\n//# sourceMappingURL=useHoverMode.js.map"]},"metadata":{},"sourceType":"module"}