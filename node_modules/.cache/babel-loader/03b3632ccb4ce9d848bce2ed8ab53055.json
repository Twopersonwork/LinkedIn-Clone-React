{"ast":null,"code":"var _jsxFileName = \"/home/prachi/workspace/LinkedIn-Clone/LinkedIn-Clone-React/linkedin_react/src/components/Feed/Feed.js\";\nimport \"./Feed.css\";\nimport InputOption from \"./InputOption\";\nimport Post from \"./Post\";\nimport ImageIcon from \"@material-ui/icons/Image\";\nimport SubscriptionsIcon from \"@material-ui/icons/Subscriptions\";\nimport EventNoteIcon from \"@material-ui/icons/EventNote\";\nimport CalendarViewDayIcon from \"@material-ui/icons/CalendarViewDay\";\nimport { Modal, Button } from \"react-bootstrap\";\nimport InsertPhotoIcon from \"@material-ui/icons/InsertPhoto\";\nimport axios from \"axios\";\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\nimport Input from \"@material-ui/core/Input\"; // import { useSelector } from 'react-redux';\n// import { selectUser } from '../../features/userSlice';\n// import { db } from '../../firebase';\n// import firebase from \"firebase\";\n\nimport FlipMove from \"react-flip-move\";\nimport React, { Component } from \"react\";\nimport { withCookies } from \"react-cookie\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Feed extends Component {\n  constructor(props) {\n    super(props);\n\n    this.submitPost = () => {\n      let form_data = new FormData();\n      form_data.append(\"image\", this.state.imageAsFile, this.state.imageAsFile.name);\n      form_data.append(\"body\", this.state.body);\n      fetch(`${process.env.REACT_APP_API_URL}/papi/create_post/`, {\n        method: \"POST\",\n        headers: {\n          \"content-type\": \"multipart/form-data\",\n          Authorization: `Token ${this.props.cookies.get(\"auth-token\").token}`\n        },\n        body: JSON.stringify({\n          form_data\n        })\n      }).then(res => res.json()).then(res => {\n        this.setState({\n          modalPost: false\n        }, function () {// window.location.reload();\n        });\n        console.log(res.data);\n      }).catch(err => console.log(err));\n    };\n\n    this.createPost = () => {\n      this.setState({\n        modalPost: true\n      } // console.log(this.state.modalPost)\n      );\n    };\n\n    this.handleBody = e => this.setState({\n      body: e.target.value\n    }, function () {\n      console.log(this.state.body);\n    });\n\n    this.state = {\n      input: \"\",\n      posts: [],\n      modalPost: false,\n      body: \"\",\n      image: \"\",\n      imageAsFile: null\n    };\n  }\n\n  componentDidMount() {\n    fetch(`${process.env.REACT_APP_API_URL}/papi/posts/`, {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Token ${this.props.cookies.get(\"auth-token\").token}`\n      }\n    }).then(resp => resp.json()).then(res => this.setState({\n      posts: res\n    }, console.log(this.state.posts))).catch(error => console.log(error));\n  } // shouldComponentUpdate(nextProps, nextState) {\n  //   console.log(\"this state \", this.state);\n  //   console.log(\"nextState\", nextState);\n  //   if (nextState.posts.length > this.state.posts.length) {\n  //     return true;\n  //   } else {\n  //     return false;\n  //   }\n  // }\n\n\n  componentDidUpdate(prevProps, prevState) {\n    // console.log(\"prevState\", prevState);\n    // console.log(\"this state\", this.state.posts.length);\n    if (prevState.posts.length != this.state.posts.length) {\n      fetch(`${process.env.REACT_APP_API_URL}/papi/posts/`, {\n        method: \"GET\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: \"Token d194a979f94b27587f743071a64f8d5c7d3dfb01\"\n        }\n      }).then(resp => resp.json()).then(res => this.setState({\n        posts: res\n      } // console.log(this.state.posts)\n      )).catch(error => console.log(error));\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"feed\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"feed__inputContainer\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          style: {\n            width: \"100%\"\n          },\n          onClick: this.createPost,\n          className: \"feed__input\",\n          children: \"Start a Post\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"feed__inputOptions\",\n          children: [/*#__PURE__*/_jsxDEV(InputOption, {\n            Icon: ImageIcon,\n            title: \"Photo\",\n            color: \"#70B5F9\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(InputOption, {\n            Icon: SubscriptionsIcon,\n            title: \"Video\",\n            color: \"#7FC15E\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(InputOption, {\n            Icon: EventNoteIcon,\n            title: \"Event\",\n            color: \"#E7A33E\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 189,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(InputOption, {\n            Icon: CalendarViewDayIcon,\n            title: \"Write article\",\n            color: \"#F5987E\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(FlipMove, {\n        children: this.state.posts.length > 0 && this.state.posts.map(post => /*#__PURE__*/_jsxDEV(Post, {\n          post: post\n        }, post.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 44\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 9\n      }, this), this.state.modalPost ? /*#__PURE__*/_jsxDEV(Modal, {\n        show: this.state.modalPost,\n        size: \"md\",\n        \"aria-labelledby\": \"contained-modal-title-vcenter\",\n        centered: true,\n        children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n          closeButton: true,\n          onClick: () => {\n            this.setState({\n              modalPost: false\n            });\n          },\n          children: /*#__PURE__*/_jsxDEV(Modal.Title, {\n            id: \"contained-modal-title-vcenter\",\n            children: \"Create a Post\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            placeholder: \"What do you want to talk about?\" // value={this.state.body}\n            ,\n            onChange: this.handleBody\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 15\n          }, this), this.state.image ? /*#__PURE__*/_jsxDEV(\"img\", {\n            className: \"post__image\",\n            src: this.state.image\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 17\n          }, this) : null]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Modal.Footer, {\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            disabled: this.state.body.length < 1,\n            type: \"submit\",\n            onClick: this.submitPost,\n            children: \"Post\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 238,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            id: \"file\" // value={this.state.image}\n            ,\n            onChange: e => this.setState({\n              image: URL.createObjectURL(e.target.files[0]),\n              imageAsFile: e.target.files[0]\n            }, console.log(this.state.image))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 11\n      }, this) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default _c = withCookies(Feed);\n\nvar _c;\n\n$RefreshReg$(_c, \"%default%\");","map":{"version":3,"sources":["/home/prachi/workspace/LinkedIn-Clone/LinkedIn-Clone-React/linkedin_react/src/components/Feed/Feed.js"],"names":["InputOption","Post","ImageIcon","SubscriptionsIcon","EventNoteIcon","CalendarViewDayIcon","Modal","Button","InsertPhotoIcon","axios","InputAdornment","Input","FlipMove","React","Component","withCookies","Feed","constructor","props","submitPost","form_data","FormData","append","state","imageAsFile","name","body","fetch","process","env","REACT_APP_API_URL","method","headers","Authorization","cookies","get","token","JSON","stringify","then","res","json","setState","modalPost","console","log","data","catch","err","createPost","handleBody","e","target","value","input","posts","image","componentDidMount","resp","error","componentDidUpdate","prevProps","prevState","length","render","width","map","post","id","URL","createObjectURL","files"],"mappings":"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","sourcesContent":["import \"./Feed.css\";\nimport InputOption from \"./InputOption\";\nimport Post from \"./Post\";\nimport ImageIcon from \"@material-ui/icons/Image\";\nimport SubscriptionsIcon from \"@material-ui/icons/Subscriptions\";\nimport EventNoteIcon from \"@material-ui/icons/EventNote\";\nimport CalendarViewDayIcon from \"@material-ui/icons/CalendarViewDay\";\nimport { Modal, Button } from \"react-bootstrap\";\nimport InsertPhotoIcon from \"@material-ui/icons/InsertPhoto\";\nimport axios from \"axios\";\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\nimport Input from \"@material-ui/core/Input\";\n\n// import { useSelector } from 'react-redux';\n// import { selectUser } from '../../features/userSlice';\n// import { db } from '../../firebase';\n// import firebase from \"firebase\";\nimport FlipMove from \"react-flip-move\";\n\nimport React, { Component } from \"react\";\nimport { withCookies } from \"react-cookie\";\n\nclass Feed extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      input: \"\",\n      posts: [],\n      modalPost: false,\n      body: \"\",\n      image: \"\",\n      imageAsFile: null,\n    };\n  }\n\n  submitPost = () => {\n    let form_data = new FormData();\n\n    form_data.append(\n      \"image\",\n      this.state.imageAsFile,\n      this.state.imageAsFile.name\n    );\n    form_data.append(\"body\", this.state.body);\n    fetch(`${process.env.REACT_APP_API_URL}/papi/create_post/`, {\n      method: \"POST\",\n      headers: {\n        \"content-type\": \"multipart/form-data\",\n        Authorization: `Token ${this.props.cookies.get(\"auth-token\").token}`,\n      },\n      body: JSON.stringify({ form_data }),\n    })\n      .then((res) => res.json())\n      .then((res) => {\n        this.setState({ modalPost: false }, function () {\n          // window.location.reload();\n        });\n\n        console.log(res.data);\n      })\n      .catch((err) => console.log(err));\n  };\n\n  // submitPost = () => {\n  //   let form_data = new FormData();\n\n  //   form_data.append(\n  //     \"image\",\n  //     this.state.imageAsFile,\n  //     this.state.imageAsFile.name\n  //   );\n  //   form_data.append(\"body\", this.state.body);\n  //   form_data.append(\"user\",this.props.cookies.get(\"auth-token\").id)\n  //   let url = `${process.env.REACT_APP_API_URL}/papi/create_post/`;\n  //   axios\n  //     .post(url, form_data, {\n  //       headers: {\n  //         \"content-type\": \"multipart/form-data\",\n  //         Authorization: \"Bearer d194a979f94b27587f743071a64f8d5c7d3dfb01\",\n  //       },\n  //     })\n  //     .then((res) => {\n  //       this.setState({ modalPost: false }, function () {\n  //         window.location.reload();\n  //       });\n\n  //       console.log(res.data);\n  //     })\n  //     .catch((err) => console.log(err));\n  // };\n\n  createPost = () => {\n    this.setState(\n      {\n        modalPost: true,\n      }\n      // console.log(this.state.modalPost)\n    );\n  };\n\n  handleBody = (e) =>\n    this.setState({ body: e.target.value }, function () {\n      console.log(this.state.body);\n    });\n\n  componentDidMount() {\n    fetch(`${process.env.REACT_APP_API_URL}/papi/posts/`, {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Token ${this.props.cookies.get(\"auth-token\").token}`,\n      },\n    })\n      .then((resp) => resp.json())\n      .then((res) =>\n        this.setState(\n          {\n            posts: res,\n          },\n          console.log(this.state.posts)\n        )\n      )\n      .catch((error) => console.log(error));\n  }\n  // shouldComponentUpdate(nextProps, nextState) {\n  //   console.log(\"this state \", this.state);\n  //   console.log(\"nextState\", nextState);\n  //   if (nextState.posts.length > this.state.posts.length) {\n  //     return true;\n  //   } else {\n  //     return false;\n  //   }\n  // }\n  componentDidUpdate(prevProps, prevState) {\n    // console.log(\"prevState\", prevState);\n    // console.log(\"this state\", this.state.posts.length);\n    if (prevState.posts.length != this.state.posts.length) {\n      fetch(`${process.env.REACT_APP_API_URL}/papi/posts/`, {\n        method: \"GET\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: \"Token d194a979f94b27587f743071a64f8d5c7d3dfb01\",\n        },\n      })\n        .then((resp) => resp.json())\n        .then((res) =>\n          this.setState(\n            {\n              posts: res,\n            }\n            // console.log(this.state.posts)\n          )\n        )\n        .catch((error) => console.log(error));\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"feed\">\n        <div className=\"feed__inputContainer\">\n          {/* <div className=\"feed__input\"> */}\n          {/* <CreateIcon /> */}\n          {/* <form>\n              <input\n                value={this.state.input}\n                onChange={(e) => this.setState({ input: e.target.value })}\n                type=\"text\"\n                placeholder=\"Start a post\"\n              /> */}\n          {/* <button onClick={sendPost} type=\"submit\">Send</button> */}\n          {/* </form> */}\n          <button\n            style={{ width: \"100%\" }}\n            onClick={this.createPost}\n            className=\"feed__input\"\n          >\n            Start a Post\n          </button>\n          {/* </div> */}\n          <div className=\"feed__inputOptions\">\n            <InputOption Icon={ImageIcon} title=\"Photo\" color=\"#70B5F9\" />\n            <InputOption\n              Icon={SubscriptionsIcon}\n              title=\"Video\"\n              color=\"#7FC15E\"\n            />\n            <InputOption Icon={EventNoteIcon} title=\"Event\" color=\"#E7A33E\" />\n            <InputOption\n              Icon={CalendarViewDayIcon}\n              title=\"Write article\"\n              color=\"#F5987E\"\n            />\n          </div>\n        </div>\n        <hr />\n\n        {/* Posts */}\n        <FlipMove>\n          {this.state.posts.length > 0 &&\n            this.state.posts.map((post) => <Post key={post.id} post={post} />)}\n        </FlipMove>\n\n        {this.state.modalPost ? (\n          <Modal\n            show={this.state.modalPost}\n            size=\"md\"\n            aria-labelledby=\"contained-modal-title-vcenter\"\n            centered\n          >\n            <Modal.Header\n              closeButton\n              onClick={() => {\n                this.setState({ modalPost: false });\n              }}\n            >\n              <Modal.Title id=\"contained-modal-title-vcenter\">\n                Create a Post\n              </Modal.Title>\n            </Modal.Header>\n            <Modal.Body>\n              {/* <p>\n                Cras mattis consectetur purus sit amet fermentum. Cras justo\n                odio, dapibus ac facilisis in, egestas eget quam. Morbi leo\n                risus, porta ac consectetur ac, vestibulum at eros.\n              </p> */}\n              <input\n                placeholder=\"What do you want to talk about?\"\n                // value={this.state.body}\n                onChange={this.handleBody}\n              />\n              {this.state.image ? (\n                <img className=\"post__image\" src={this.state.image} />\n              ) : null}\n            </Modal.Body>\n            <Modal.Footer>\n              <Button\n                disabled={this.state.body.length < 1}\n                type=\"submit\"\n                onClick={this.submitPost}\n              >\n                Post\n              </Button>\n              <input\n                type=\"file\"\n                id=\"file\"\n                // value={this.state.image}\n\n                onChange={(e) =>\n                  this.setState(\n                    {\n                      image: URL.createObjectURL(e.target.files[0]),\n                      imageAsFile: e.target.files[0],\n                    },\n                    console.log(this.state.image)\n                  )\n                }\n              />\n            </Modal.Footer>\n          </Modal>\n        ) : null}\n      </div>\n    );\n  }\n}\n\nexport default withCookies(Feed);\n"]},"metadata":{},"sourceType":"module"}